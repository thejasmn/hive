PREHOOK: query: -- current user has been set (comment line before the set cmd is resulting in parse error!!)

CREATE TABLE  table_priv1(i int)
PREHOOK: type: CREATETABLE
POSTHOOK: query: -- current user has been set (comment line before the set cmd is resulting in parse error!!)

CREATE TABLE  table_priv1(i int)
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: default@table_priv1
PREHOOK: query: -- all privileges should have been set for user

-- grant insert privilege to another user
GRANT INSERT ON table_priv1 TO USER user2
PREHOOK: type: GRANT_PRIVILEGE
PREHOOK: Output: default@table_priv1
POSTHOOK: query: -- all privileges should have been set for user

-- grant insert privilege to another user
GRANT INSERT ON table_priv1 TO USER user2
POSTHOOK: type: GRANT_PRIVILEGE
POSTHOOK: Output: default@table_priv1
PREHOOK: query: SHOW GRANT USER user2 ON TABLE table_priv1
PREHOOK: type: SHOW_GRANT
POSTHOOK: query: SHOW GRANT USER user2 ON TABLE table_priv1
POSTHOOK: type: SHOW_GRANT
database	default
table	table_priv1
principalName	user2
principalType	USER
privilege	INSERT
#### A masked pattern was here ####
grantor	user1
PREHOOK: query: -- grant select privilege to another user with grant
GRANT SELECT ON table_priv1 TO USER user2 with grant option
PREHOOK: type: GRANT_PRIVILEGE
PREHOOK: Output: default@table_priv1
POSTHOOK: query: -- grant select privilege to another user with grant
GRANT SELECT ON table_priv1 TO USER user2 with grant option
POSTHOOK: type: GRANT_PRIVILEGE
POSTHOOK: Output: default@table_priv1
PREHOOK: query: SHOW GRANT USER user2 ON TABLE table_priv1
PREHOOK: type: SHOW_GRANT
POSTHOOK: query: SHOW GRANT USER user2 ON TABLE table_priv1
POSTHOOK: type: SHOW_GRANT
database	default
table	table_priv1
principalName	user2
principalType	USER
privilege	INSERT
#### A masked pattern was here ####
grantor	user1
database	default
table	table_priv1
principalName	user2
principalType	USER
privilege	SELECT
#### A masked pattern was here ####
grantor	user1
PREHOOK: query: -- change to other user - user2
-- grant permissions to another user as user2
GRANT SELECT ON table_priv1 TO USER user3 with grant option
PREHOOK: type: GRANT_PRIVILEGE
PREHOOK: Output: default@table_priv1
POSTHOOK: query: -- change to other user - user2
-- grant permissions to another user as user2
GRANT SELECT ON table_priv1 TO USER user3 with grant option
POSTHOOK: type: GRANT_PRIVILEGE
POSTHOOK: Output: default@table_priv1
PREHOOK: query: SHOW GRANT USER user3 ON TABLE table_priv1
PREHOOK: type: SHOW_GRANT
POSTHOOK: query: SHOW GRANT USER user3 ON TABLE table_priv1
POSTHOOK: type: SHOW_GRANT
database	default
table	table_priv1
principalName	user3
principalType	USER
privilege	SELECT
#### A masked pattern was here ####
grantor	user2
PREHOOK: query: -- change to other user - user3
-- grant permissions to another user as user3
GRANT SELECT ON table_priv1 TO USER user4 with grant option
PREHOOK: type: GRANT_PRIVILEGE
PREHOOK: Output: default@table_priv1
POSTHOOK: query: -- change to other user - user3
-- grant permissions to another user as user3
GRANT SELECT ON table_priv1 TO USER user4 with grant option
POSTHOOK: type: GRANT_PRIVILEGE
POSTHOOK: Output: default@table_priv1
PREHOOK: query: SHOW GRANT USER user4 ON TABLE table_priv1
PREHOOK: type: SHOW_GRANT
POSTHOOK: query: SHOW GRANT USER user4 ON TABLE table_priv1
POSTHOOK: type: SHOW_GRANT
database	default
table	table_priv1
principalName	user4
principalType	USER
privilege	SELECT
#### A masked pattern was here ####
grantor	user3
#### A masked pattern was here ####

-- grant all with grant to user22
GRANT ALL ON table_priv1 TO USER user22 with grant option
PREHOOK: type: GRANT_PRIVILEGE
PREHOOK: Output: default@table_priv1
#### A masked pattern was here ####

-- grant all with grant to user22
GRANT ALL ON table_priv1 TO USER user22 with grant option
POSTHOOK: type: GRANT_PRIVILEGE
POSTHOOK: Output: default@table_priv1
PREHOOK: query: SHOW GRANT USER user22 ON TABLE table_priv1
PREHOOK: type: SHOW_GRANT
POSTHOOK: query: SHOW GRANT USER user22 ON TABLE table_priv1
POSTHOOK: type: SHOW_GRANT
database	default
table	table_priv1
principalName	user22
principalType	USER
privilege	DELETE
#### A masked pattern was here ####
grantor	user1
database	default
table	table_priv1
principalName	user22
principalType	USER
privilege	INSERT
#### A masked pattern was here ####
grantor	user1
database	default
table	table_priv1
principalName	user22
principalType	USER
privilege	SELECT
#### A masked pattern was here ####
grantor	user1
database	default
table	table_priv1
principalName	user22
principalType	USER
privilege	UPDATE
#### A masked pattern was here ####
grantor	user1
PREHOOK: query: -- grant all without grant to user33
GRANT ALL ON table_priv1 TO USER user33 with grant option
PREHOOK: type: GRANT_PRIVILEGE
PREHOOK: Output: default@table_priv1
POSTHOOK: query: -- grant all without grant to user33
GRANT ALL ON table_priv1 TO USER user33 with grant option
POSTHOOK: type: GRANT_PRIVILEGE
POSTHOOK: Output: default@table_priv1
PREHOOK: query: SHOW GRANT USER user33 ON TABLE table_priv1
PREHOOK: type: SHOW_GRANT
POSTHOOK: query: SHOW GRANT USER user33 ON TABLE table_priv1
POSTHOOK: type: SHOW_GRANT
database	default
table	table_priv1
principalName	user33
principalType	USER
privilege	DELETE
#### A masked pattern was here ####
grantor	user22
database	default
table	table_priv1
principalName	user33
principalType	USER
privilege	INSERT
#### A masked pattern was here ####
grantor	user22
database	default
table	table_priv1
principalName	user33
principalType	USER
privilege	SELECT
#### A masked pattern was here ####
grantor	user22
database	default
table	table_priv1
principalName	user33
principalType	USER
privilege	UPDATE
#### A masked pattern was here ####
grantor	user22
